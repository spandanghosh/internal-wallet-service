# =============================================================================
# Test-environment overrides for src/main/resources/application.properties
# =============================================================================

# Provide placeholder values for the env-var placeholders used in the main
# application.properties.  The EnvironmentPostProcessor (JdbcUrlNormalizer)
# runs very early — before @DynamicPropertySource — and calls
# environment.getProperty("spring.datasource.url"), which in turn tries to
# resolve ${SPRING_DATASOURCE_URL}.  Without this file that resolution throws
# IllegalArgumentException and the normalizer bails out silently.
#
# @DynamicPropertySource in each test class later overrides spring.datasource.*
# with the actual Testcontainers URL, so these placeholder values are never
# used for real database connections.
SPRING_DATASOURCE_URL=jdbc:postgresql://localhost:5432/placeholder
SPRING_DATASOURCE_USERNAME=test
SPRING_DATASOURCE_PASSWORD=test

# Keep SQL init enabled so Spring Boot runs schema.sql against the fresh
# Testcontainers PostgreSQL on context startup (creates all tables).
spring.sql.init.mode=always

# Point SQL init at the test schema only (tighter CHECK constraint).
# data.sql from main resources still runs but is idempotent; each test's
# @Sql truncate+seed resets state before the test body executes.
spring.sql.init.schema-locations=classpath:schema.sql

# =============================================================================
# Jackson — must repeat these here because src/test/resources/application.properties
# SHADOWS (replaces) src/main/resources/application.properties in the Spring
# Boot test context. The main file's properties are not visible to tests.
# =============================================================================
spring.jackson.property-naming-strategy=SNAKE_CASE
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.default-property-inclusion=non_null
